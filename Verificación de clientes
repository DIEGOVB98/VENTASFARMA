import streamlit as st
import pandas as pd
import os

# === Configuración de la base de datos ===
DB_PATH = "ventas.csv"

def cargar_base():
    if os.path.exists(DB_PATH):
        return pd.read_csv(DB_PATH)
    else:
        return pd.DataFrame(columns=["codigo"])

def guardar_base(df):
    df.to_csv(DB_PATH, index=False)

# === Interfaz de usuario ===
st.set_page_config(page_title="Control de Ventas", page_icon="🧾", layout="centered")
st.title("🧾 Verificación de Venta de Producto")

codigo = st.text_input("🔎 Ingresa el código del cliente:")

if st.button("Verificar"):
    if not codigo:
        st.warning("⚠️ Por favor, ingresa un código válido.")
    else:
        base = cargar_base()
        if codigo in base["codigo"].values:
            st.error(f"⚠️ El código '{codigo}' ya tiene una venta registrada.")
        else:
            st.success(f"✅ El código '{codigo}' NO tiene venta registrada.")
            if st.button("✅ Confirmar venta"):
                base = base.append({"codigo": codigo}, ignore_index=True)
                guardar_base(base)
                st.success(f"✔️ Venta registrada para el código '{codigo}'.")
